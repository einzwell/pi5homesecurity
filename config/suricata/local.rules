# CHAOS RAT Rules
#drop http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE CHAOS RAT/AlfaC2 Client Checkin"; flow:established,to_server; http.uri; bsize:7; content:"/client"; http.user_agent; content:"Go-http-client/"; startswith; http.header_names; content:"|0d 0a|X-Client|0d 0a|"; fast_pattern; http.header; content:"Upgrade|3a 20|websocket|0d 0a|"; content:"X-Client|3a 20|"; pcre:"/^(?:[a-f0-9]{2}\x3a){5}[a-f0-9]{2}[\r\n]+$/Rm"; http.cookie; content:"jwt="; startswith; content:".eyJhdXRob3JpemVkIj"; distance:0; content:!"|3b|"; distance:0; reference:md5,d0ea84204096109f18a2201fae1c4f30; reference:url,github.com/tiagorlampert/CHAOS; classtype:command-and-control; sid:2046872; rev:2; metadata:attack_target Client_and_Server, created_at 2023_07_20, deployment Perimeter, malware_family CHAOS, performance_impact Low, confidence High, signature_severity Critical, tag RemoteAccessTool, updated_at 2023_11_27; target:src_ip;)
#drop http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE CHAOS RAT/AlfaC2 CnC Server Status Check"; flow:established,to_server; http.uri; bsize:7; content:"/health"; http.user_agent; content:"Go-http-client/"; startswith; http.content_type; bsize:16; content:"application/json"; http.cookie; content:"jwt="; startswith; content:".eyJhdXRob3JpemVkIj"; fast_pattern; distance:0; content:!"|3b|"; distance:0; reference:md5,d0ea84204096109f18a2201fae1c4f30; reference:url,github.com/tiagorlampert/CHAOS; classtype:command-and-control; sid:2046873; rev:2; metadata:attack_target Client_and_Server, created_at 2023_07_20, deployment Perimeter, malware_family CHAOS, performance_impact Low, confidence Medium, signature_severity Critical, tag RemoteAccessTool, updated_at 2023_11_27; target:src_ip;)
alert tcp any any -> 192.168.1.181 any (msg:"[LOCAL] Bardi RTSP Access"; content:"RTSP/"; classtype:misc-activity; sid:9625001; rev:1;)
drop tcp any any -> 192.168.1.77 5555 (msg:"[LOCAL] Xiaomi MiTV ADB Access"; classtype:misc-activity; sid:9625002; rev:1;)
alert http any any -> 192.168.1.77 [8008, 8009, 8443] (msg:"[LOCAL] Xiaomi MiTV Chromecast Connection"; classtype:misc-activity; sid:962503; rev:1;)
alert tcp any !$HTTP_PORTS -> $HOME_NET any (msg:"[LOCAL] Potential TCP SYN Flood"; flags:S; classtype:attempted-dos; sid:962504; rev:1;)
alert icmp any any -> $HOME_NET any (msg:"[LOCAL] Potential ICMP Flood"; itype:8; icode:0; classtype:attempted-dos; sid:962505; rev:1;)
alert udp any any -> $HOME_NET any (msg:"[LOCAL] Potential UDP Flood"; flow:not_established,to_server; flowbits:isnotset,udp_verify; flowbits:set,udp_verify; classtype:attempted-dos; sid:962506; rev:1;)
alert http any any -> 192.168.1.1 443 (msg:"[LOCAL] Router Control Panel Access"; classtype:misc-activity; sid:962507; rev:1;)
